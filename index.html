<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>List FDB V2.4</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: #f5f7fa;
      color: #333;
      padding: 20px;
      text-align: center;
      user-select: none;
    }
    .container {
      display: flex;
      gap: 30px;
      justify-content: center;
      margin-top: 20px;
    }
    .box.original, .box.reorder {
      width: 100%;
      max-width: 450px;
      padding: 15px;
      border-radius: 10px;
    }
    .box.original {
      background: #e0e0e0;
      box-shadow: inset 0px 2px 5px rgba(0, 0, 0, 0.1);
    }
    .box.reorder {
      background: white;
      box-shadow: 0px 4px 10px rgba(0,0,0,0.15);
    }
    h3 { margin-bottom: 15px; font-size: 1.2rem; color: #444; }
    ul { list-style: none; padding: 0; margin: 0; }
    .original-list li {
      background: #d6d6d6;
      padding: 10px;
      margin-bottom: 6px;
      border-radius: 6px;
      font-weight: bold;
    }
    .reorder-list li {
      background: #fff;
      padding: 10px;
      margin-bottom: 6px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      cursor: grab;
    }
    .number { font-weight: bold; margin-right: 6px; }
    .note-input { width: 120px; padding: 5px; font-size: 0.85rem; }
    button {
      background: #007BFF;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s;
      font-size: 0.9rem;
    }
    button:hover { background: #0056b3; }
    @media(max-width:768px) {
      .container { flex-direction: column; gap: 20px; }
    }
  </style>
</head>
<body>
  <h1>List Ulang FDB</h1>

  <div class="top-controls">
    <select id="nameInput">
      <option value="">Pilih nama</option>
      <option value="Rendi">Rendi</option>
      <option value="Irma">Irma</option>
      <option value="Gupron">Gupron</option>
      <option value="Afrizal">Afrizal</option>
      <option value="Fahmi">Fahmi</option>
      <option value="Satriya">Satriya</option>
      <option value="Anas">Anas</option>
      <option value="Zen">Zen</option>
      <option value="Lintang">Lintang</option>
      <option value="Fajrul">Fajrul</option>
      <option value="Erich">Erich</option>
    </select>
    <input type="text" id="searchInput" placeholder="eg. GX-DPS-83274">
    <button onclick="mockSearch()">Search</button>
  </div>

  <p style="color:red;">JIKA DATA TIDAK MUNCUL KODE FDB SALAH!</p>

  <div class="container">
    <div class="box original">
      <h3>List FDB GX Networks</h3>
      <ul id="original-list" class="original-list"></ul>
    </div>
    <div class="box reorder">
      <h3>
        List ulang FDB 
        <button onclick="saveOrder()">Submit</button>
      </h3>
      <ul id="sortable-list" class="reorder-list"></ul>
    </div>
  </div>

  <script>
    // ðŸš€ Mock data untuk demo (karena fetch ke IP privat tidak bisa di GitHub Pages)
    function mockSearch() {
      const name = document.getElementById("nameInput").value;
      const search = document.getElementById("searchInput").value;
      if (!name || !search) {
        alert("Isi nama dan kode FDB dulu");
        return;
      }
      const data = ["UID-001", "UID-002", "UID-003", "UID-004"];
      updateLists(data);
    }

    function updateLists(data) {
      let orig = document.getElementById("original-list");
      let reorder = document.getElementById("sortable-list");
      orig.innerHTML = "";
      reorder.innerHTML = "";
      data.forEach((item, idx) => {
        let li1 = document.createElement("li");
        li1.innerHTML = `<span class="number">${idx+1}.</span> ${item}`;
        orig.appendChild(li1);

        let li2 = document.createElement("li");
        li2.draggable = true;
        li2.innerHTML = `
          <span class="number">${idx+1}.</span>
          <span>${item}</span>
          <input type="text" class="note-input" placeholder="note">
        `;
        reorder.appendChild(li2);
      });
      makeReorderable();
    }

    function makeReorderable() {
      const list = document.getElementById("sortable-list");
      let dragging;
      list.querySelectorAll("li").forEach(li => {
        li.addEventListener("dragstart", () => dragging = li);
        li.addEventListener("dragover", e => e.preventDefault());
        li.addEventListener("drop", e => {
          e.preventDefault();
          if (dragging && dragging !== li) {
            list.insertBefore(dragging, li.nextSibling);
            updateNumbers();
          }
        });
      });
    }

    function updateNumbers() {
      document.querySelectorAll("#sortable-list li .number").forEach((n,i)=>{
        n.textContent = `${i+1}.`;
      });
    }

    function saveOrder() {
      const name = document.getElementById("nameInput").value;
      const search = document.getElementById("searchInput").value;
      if (!name || !search) {
        alert("Isi nama dan kode FDB dulu");
        return;
      }
      let result = [];
      document.querySelectorAll("#sortable-list li").forEach((li,i)=>{
        let text = li.querySelector("span:nth-child(2)").textContent.trim();
        let note = li.querySelector(".note-input").value.trim();
        result.push(note ? `${i+1}. ${text} - ${note}` : `${i+1}. ${text}`);
      });
      // ðŸ”— Kirim balik ke bot via Telegram WebApp API
      Telegram.WebApp.sendData(JSON.stringify({
        name: name,
        fdb: search,
        list: result
      }));
      alert("âœ… Data dikirim ke bot!");
    }
  </script>
</body>
</html>
